<!DOCTYPE html>
<html>

<head>
    <title>Direct Google Form Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
        }

        button {
            padding: 10px 20px;
            background: #4285f4;
            color: white;
            border: none;
            cursor: pointer;
            margin: 10px 0;
        }

        .result {
            margin: 20px 0;
            padding: 15px;
            background: #f5f5f5;
            border-radius: 5px;
        }

        .success {
            background: #d4edda;
            color: #155724;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
        }
    </style>
</head>

<body>
    <h1>Direct Google Form Submission Test</h1>

    <h3>Test 1: Company Submission</h3>
    <button onclick="testCompany()">Submit as Company</button>

    <h3>Test 2: Individual Submission</h3>
    <button onclick="testIndividual()">Submit as Individual</button>

    <div id="result"></div>

    <script>
        function testCompany() {
            submitForm({
                'entry.377608779': 'Yes, I represent a company',
                'entry.275916791': 'Test Company Ltd',
                'entry.952443479': 'Germany',
                'entry.246526021': 'company@test.com',
                'entry.218981205': '+49123456789',
                'entry.378912780': 'Test Product',
                'entry.1546397977': 'This is a test submission for company',
                'entry.1663388540': '10,000 - 25,000',
                'entry.545241450': 'email'
            }, 'Company');
        }

        function testIndividual() {
            submitForm({
                'entry.377608779': "No, I'm an individual",
                'entry.275916791': '',
                'entry.952443479': '',
                'entry.246526021': 'individual@test.com',
                'entry.218981205': '',
                'entry.378912780': 'Personal Product',
                'entry.1546397977': 'This is a test submission for individual',
                'entry.1663388540': 'under 5,000',
                'entry.545241450': 'whatsapp'
            }, 'Individual');
        }

        function submitForm(fields, testType) {
            const form = document.createElement('form');
            form.action = 'https://docs.google.com/forms/d/e/1FAIpQLSdSs_m4wi7gyHN3CrzAUcLVP4jBmmXDAghslEQQ-gDK7V94rg/formResponse';
            form.method = 'POST';
            form.target = 'hidden_iframe';
            form.style.display = 'none';

            Object.entries(fields).forEach(([name, value]) => {
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = name;
                input.value = value;
                form.appendChild(input);
            });

            document.body.appendChild(form);

            const resultDiv = document.getElementById('result');
            resultDiv.className = 'result';
            resultDiv.innerHTML = `<p>Submitting ${testType} test...</p>`;

            form.submit();

            setTimeout(() => {
                document.body.removeChild(form);
                resultDiv.className = 'result success';
                resultDiv.innerHTML = `
                    <p><strong>âœ… ${testType} Test Submitted!</strong></p>
                    <p>Check your Google Sheet now. If a new row appeared, the form is working.</p>
                    <p>If not, there's an issue with the Google Form configuration.</p>
                `;
            }, 1000);
        }
    </script>

    <iframe name="hidden_iframe" style="display: none;"></iframe>
</body>

</html>